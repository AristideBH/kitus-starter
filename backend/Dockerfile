FROM directus/directus:latest

# Set environment variables
ENV KEY=${DIRECTUS_KEY}
ENV SECRET=${DIRECTUS_SECRET}
ENV PUBLIC_URL=${PUBLIC_URL}
ENV DB_CLIENT=mysql
ENV DB_HOST=${DB_HOST}
ENV DB_PORT=${DB_PORT}
ENV DB_DATABASE=${MYSQL_DATABASE}
ENV DB_USER=${MYSQL_USER}
ENV DB_PASSWORD=${MYSQL_PASSWORD}
ENV CACHE_ENABLED=true
ENV CACHE_STORE=redis
ENV CACHE_AUTO_PURGE=${CACHE_AUTO_PURGE}
ENV CACHE_TTL=${CACHE_TTL}
ENV REDIS=${REDIS_URL}
ENV ADMIN_EMAIL=${ADMIN_EMAIL}
ENV ADMIN_PASSWORD=${ADMIN_PASSWORD}

# Create volumes
VOLUME /directus/uploads
VOLUME /directus/extensions

# Expose Directus port
EXPOSE 8055

# Start Directus
CMD ["npx", "directus", "start"]
